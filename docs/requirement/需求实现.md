# 需求实现

> 2023/06
>
> 面试高级前端开发的过程中, 深深感觉到设计思想和前端基础的不足, 所以现在开始每天实现一些需求, 来提升自己的能力

---

## 任务池

### 需求分析

- 创建一个任务池，可以添加异步任务，设置最小运行(min)和最大运行(max)，满足条件时，会自动运行`IDLE`和`ERROR`的任务，`ERROR`任务重试最大为3次，失败后，状态改为`STOP`
- 任务池可暂停， 暂停后，正在发送但未返回的任务，会停止，等待任务池的启动
- 异步任务：每个任务有`IDLE`   `SUCCESS`  `ERROR`  `PENDING`  `STOP` 五种状态

### 参考

> - [js实现"线程池"限制异步任务数量](https://segmentfault.com/a/1190000040210949?sort=newest)
>
> - [JavaScript 任务池](https://www.cnblogs.com/xhyccc/p/16268522.html)
> - [generic-pool](https://www.npmjs.com/package/generic-pool)
> - [客户端JavaScript的线程池设计详解](https://www.jb51.net/article/235676.htm)

---

## 大文件上传

### 需求分析

1. 前端
   - 分块，切片
2. 后端
   - 接收分片



### 学习

1. `blob.slice(start, end, contentType)`
   - 返回新的blob对象
   - contentType决定`URL.createObjectURL()`创建链接解码的默认行为
   - [所有Content-Type字典](https://tool.oschina.net/commons/_contenttype.dea)
   - [JS 检测上传文件类型](https://github.com/jealyn/real-file-type)
     - [file-type](https://www.npmjs.com/package/file-type)
     - [List_of_file_signatures](https://en.wikipedia.org/wiki/List_of_file_signatures)
     - [Magic bytes](https://github.com/LarsKoelpin/magic-bytes/)



### 参考

> - https://zhuanlan.zhihu.com/p/386493135?utm_id=0
> - [multiparty - npm](https://www.npmjs.com/package/multiparty)
> - [字节跳动面试官，我也实现了大文件上传和断点续传](https://juejin.cn/post/6844904055819468808#heading-6)
> - [input file 文件框“取消”按钮事件](https://www.jianshu.com/p/b41a21a399e4)
> - [写给新手前端的各种文件上传攻略，从小图片到大文件断点续传](https://cloud.tencent.com/developer/article/1532107)



---

## websocket客户端

### 需求分析

> 题目：设计一个websocket客户端模块给团队人员使用
> 要求：稳定性和可用性，不需要考虑安全性，扩展性等其他因素
> 考察要点：如何通过设计机制来保证强稳定性，需要考虑到各种情况，保证业务高可用
>
> 技术方式不限，ws相关代码用js，不引入现有生态的ws的npm库


### 实现功能

- 连接错误处理：当连接失败时，你需要监听error事件和close事件，获取错误信息和关闭码，并尝试重新连接或报告错误。
- 心跳检测：为了检测和关闭断开的连接，你需要定期发送心跳包（ping帧）并等待响应（pong帧）。如果没有收到响应，你可以关闭连接并重新连接
- 数据压缩：你可以使用permessage-deflate扩展来压缩数据负载。这个扩展可以在客户端和服务器之间协商压缩算法和参数

### 参考

- https://cloud.tencent.com/developer/article/2168088
- https://juejin.cn/post/7128030988479037447
- https://github.com/nuls-io/nuls-v2-docs/blob/master/design-zh-CHS/r.rpc-tool-websocket%E8%AE%BE%E8%AE%A1v1.3.md
- https://socket.io/zh-CN/docs/v4/
- https://blog.csdn.net/niugang0920/article/details/83686205
- [十分钟了解WebSocket协议](https://zhuanlan.zhihu.com/p/145628937)
  - 基于TCP/IP协议，独立于HTTP协议的通信协议
  - 双向通讯，有状态，客户端一（多）个与服务端一（多）双向实时响应（客户端 ⇄ 服务端）
  - 应用在浏览器的 Socket （是 Socket 模型接口的实现），Socket 是一个网络通信接口 （通信规范）
  - [RFC 6455 规范](https://link.zhihu.com/?target=https%3A//tools.ietf.org/html/rfc6455) 是大多数浏览器实现的 WebSocket API 协议。
  - **WebSocket协议不受同源策略影响。**
  - 发心跳包最好服务器发送？

- [WebSockets版本之间的协议差异是什么？](http://news.558idc.com/94700.html)

- [使用WebSocket 时的安全注意事项](https://zhuanlan.zhihu.com/p/628423871)
- [Websocket 可以玩出些什么花儿？](https://zhuanlan.zhihu.com/p/460470270)
- [WebSocket 浅析](https://zhuanlan.zhihu.com/p/25592934)
- [websocket长文本问题？](https://segmentfault.com/q/1010000010620489)
- 待看
  - https://www.cnblogs.com/cangqinglang/p/15991378.html
  - [【译】Engine.IO协议](https://www.kevinwu0904.top/blogs/network-engineio/)

---

## 图片懒加载

### 参考

> - [Vue.js：图片懒加载和预加载的实现与原理](https://juejin.cn/post/6844904046436843527#heading-25)

---

## 虚拟树形结构

### 参考

element-ui, ant-design

---

## 前端监控

### 参考

掘金

---

## WebGl

### 参考

掘金

---

## GIS

### 参考

b站视频

---
